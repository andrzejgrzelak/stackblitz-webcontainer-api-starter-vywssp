"use strict";(self.webpackChunk_jbrowse_web=self.webpackChunk_jbrowse_web||[]).push([[8941],{58941:function(e,n,t){t.r(n),t.d(n,{Attributes:function(){return de},BaseAttributes:function(){return fe},BaseCard:function(){return $},BaseCoreDetails:function(){return se},BasicValue:function(){return ne},FeatureDetails:function(){return me},FieldName:function(){return ee},SimpleValue:function(){return te},UriLink:function(){return ce},default:function(){return xe},useStyles:function(){return Y}});var r=t(59740),i=t(41361),a=t(33028),o=t(68079),s=t(96234),c=t(96902),u=t(69029),l=t(50952),d=t(75695),f=t(35388),p=t(53244),m=t(50543),x=t(63348),v=t(12546),h=t(91188),Z=t(4514),j=t(4782),g=t(71112),b=t.n(g),w=t(59959),y=t(97531),S=t(46186),C=t(32723),k=t(34795),N=t(44536),_=t(13655),L=t(25322),D=t(33266),B=t(15996),F=t(21051),T=t.n(F),q=t(99836),E=t(25471),M=t(57900),O=t(29938),U=(0,c.lazy)((function(){return t.e(7098).then(t.bind(t,37098))})),I=(0,c.lazy)((function(){return t.e(4609).then(t.bind(t,4609))})),z=(0,c.lazy)((function(){return t.e(6431).then(t.bind(t,26431))})),R=(0,h.ZL)()((function(e){return{button:{margin:e.spacing(1)},formControl:{margin:0},container:{margin:e.spacing(1)},container2:{marginTop:e.spacing(1)}}})),A=5e5;function G(e){var n,t=e.model,r=e.feature,i=R().classes,a=!(null===(n=r.subfeatures)||void 0===n||!n.find((function(e){return"CDS"===e.type}))),o="gene"===r.type,u=(0,c.useState)(!1),l=(0,s.Z)(u,2),d=l[0],f=l[1],p=(0,c.useState)(!1),m=(0,s.Z)(p,2),x=m[0],v=m[1];return o&&!a||!t?null:(0,O.jsxs)("div",{className:i.container2,children:[(0,O.jsx)(N.Z,{variant:"contained",onClick:function(){return f(!d)},children:d?"Hide feature sequence":"Show feature sequence"}),(0,O.jsx)(_.Z,{className:i.formControl,children:(0,O.jsx)(L.Z,{onClick:function(){return v(!0)},children:(0,O.jsx)(M.Z,{})})}),(0,O.jsx)("br",{}),d?(0,O.jsx)(H,{model:t,feature:r}):null,x?(0,O.jsx)(c.Suspense,{fallback:(0,O.jsx)("div",{}),children:(0,O.jsx)(I,{handleClose:function(){return v(!1)}})}):null]})}function H(e){var n,t=e.model,r=e.feature,i=R().classes,o=r,u=!(null===(n=o.subfeatures)||void 0===n||!n.find((function(e){return"CDS"===e.type}))),l=(0,c.useRef)(null),d=(0,c.useState)(!1),p=(0,s.Z)(d,2),x=p[0],v=p[1],h=(0,y.useLocalStorage)("intronBp",10),Z=(0,s.Z)(h,2),j=Z[0],g=Z[1],b=(0,y.useLocalStorage)("upDownBp",500),w=(0,s.Z)(b,2),F=w[0],M=w[1],I=(0,c.useState)(),G=(0,s.Z)(I,2),H=G[0],P=G[1],J=(0,c.useState)(),V=(0,s.Z)(J,2),W=V[0],K=V[1],Q=(0,c.useState)(!1),X=(0,s.Z)(Q,2),Y=X[0],$=X[1],ee=(0,c.useState)(!1),ne=(0,s.Z)(ee,2),te=ne[0],re=ne[1],ie=(0,c.useState)({id:r.uniqueId,force:!1}),ae=(0,s.Z)(ie,2),oe=ae[0],se=ae[1];(0,c.useEffect)((function(){se({id:r.uniqueId,force:!1})}),[r]),(0,c.useEffect)((function(){var e,n=!1;if(!t)return function(){};var i=(0,y.getSession)(t),a=i.assemblyManager,o=i.rpcManager,c=(null===(e=t.view)||void 0===e?void 0:e.assemblyNames)||[],u=(0,s.Z)(c,1)[0];function l(e,n,t){return d.apply(this,arguments)}function d(){return(d=(0,k.Z)((0,C.Z)().mark((function e(n,t,r){var i,c,l,d,f,p;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.waitForAssembly(u);case 2:if(i=e.sent){e.next=5;break}throw new Error("assembly not found");case 5:return c="getSequence",e.next=8,o.call(c,"CoreGetFeatures",{adapterConfig:(0,q.getConf)(i,["sequence","adapter"]),sessionId:c,regions:[{start:n,end:t,refName:i.getCanonicalRefName(r),assemblyName:u}]});case 8:return l=e.sent,d=l,f=(0,s.Z)(d,1),p=f[0],e.abrupt("return",(null===p||void 0===p?void 0:p.get("seq"))||"");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,k.Z)((0,C.Z)().mark((function e(){var t,i,a,o,s,c,u;return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,K(void 0),i=(t=r).start,a=t.end,o=t.refName,oe.force||!(a-i>A)){e.next=7;break}P({error:"Genomic sequence larger than ".concat(A,'bp, use "force load" button to display')}),e.next=17;break;case 7:return e.next=9,l(i,a,o);case 9:return s=e.sent,e.next=12,l(Math.max(0,i-F),i,o);case 12:return c=e.sent,e.next=15,l(a,a+F,o);case 15:u=e.sent,n||P({seq:s,upstream:c,downstream:u});case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),console.error(e.t0),K(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,19]])})))(),function(){n=!0}}),[r,t,F,oe]);var ce=!H,ue=(0,y.getSession)(t),le=(0,q.getConf)(ue,["featureDetails","sequenceTypes"])||["mRNA","transcript","gene"],de="CDS"===r.type?le.includes("CDS")&&!r.parentId:le.includes(r.type),fe=de?u?"cds":"cdna":"genomic";(0,c.useEffect)((function(){ve(fe)}),[de,fe]);var pe=(0,c.useState)(de?u?"cds":"cdna":"genomic"),me=(0,s.Z)(pe,2),xe=me[0],ve=me[1],he={gene:"Gene w/ introns",gene_collapsed_intron:"Gene w/ ".concat(j,"bp of intron"),gene_updownstream:"Gene w/ ".concat(F,"bp up+down stream"),gene_updownstream_collapsed_intron:"Gene w/ ".concat(F,"bp up+down stream w/ ").concat(j,"bp intron"),cdna:"cDNA"},Ze=de?u?(0,a.Z)({cds:"CDS",protein:"Protein"},he):he:{genomic:"Genomic seq",genomic_sequence_updown:"Genomic seq w/ ".concat(F,"bp up+down stream")};return(0,O.jsxs)("div",{className:i.container2,children:[(0,O.jsx)(_.Z,{className:i.formControl,children:(0,O.jsx)(D.Z,{value:xe,onChange:function(e){return ve(e.target.value)},children:Object.entries(Ze).map((function(e){var n=(0,s.Z)(e,2),t=n[0],r=n[1];return(0,O.jsx)(B.Z,{value:t,children:r},t)}))})}),(0,O.jsx)(_.Z,{className:i.formControl,children:(0,O.jsx)(N.Z,{className:i.button,variant:"contained",onClick:function(){var e=l.current;e&&(T()(e.textContent||"",{format:"text/plain"}),$(!0),setTimeout((function(){return $(!1)}),1e3))},children:Y?"Copied to clipboard!":"Copy plaintext"})}),(0,O.jsx)(_.Z,{className:i.formControl,children:(0,O.jsx)(m.Z,{title:"The 'Copy HTML' function retains the colors from the sequence panel but cannot be pasted into some programs like notepad that only expect plain text",children:(0,O.jsx)(N.Z,{className:i.button,variant:"contained",onClick:function(){var e=l.current;e&&(T()(e.innerHTML,{format:"text/html"}),re(!0),setTimeout((function(){return re(!1)}),1e3))},children:te?"Copied to clipboard!":"Copy HTML"})})}),(0,O.jsx)(_.Z,{className:i.formControl,children:(0,O.jsx)(L.Z,{onClick:function(){return v(!0)},children:(0,O.jsx)(E.Z,{})})}),(0,O.jsx)("br",{}),W?(0,O.jsx)(f.Z,{color:"error",children:"".concat(W)}):ce?(0,O.jsx)(S.LoadingEllipses,{}):H?"error"in H?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(f.Z,{color:"error",children:H.error}),(0,O.jsx)(N.Z,{variant:"contained",color:"inherit",onClick:function(){return se((0,a.Z)((0,a.Z)({},oe),{},{force:!0}))},children:"Force load"})]}):(0,O.jsx)(c.Suspense,{fallback:(0,O.jsx)("div",{children:"Loading"}),children:(0,O.jsx)(z,{ref:l,feature:o,mode:xe,sequence:H,intronBp:j})}):(0,O.jsx)(f.Z,{children:"No sequence found"}),x?(0,O.jsx)(c.Suspense,{fallback:(0,O.jsx)("div",{}),children:(0,O.jsx)(U,{handleClose:function(e){if(e){var n=e.upDownBp,t=e.intronBp;g(t),M(n)}v(!1)},upDownBp:F,intronBp:j})}):null]})}var P=t(89378),J=["id"],V=["__jbrowsefmt"],W=["omitSingleLevel"],K=170,Q=["__jbrowsefmt","length","position","subfeatures","uniqueId","exonFrames","parentId","thickStart","thickEnd"],X=["name","start","end","strand","refName","description","type"],Y=(0,h.ZL)()((function(e){var n;return{expansionPanelDetails:{display:"block",padding:e.spacing(1)},expandIcon:{color:(null===(n=e.palette.tertiary)||void 0===n?void 0:n.contrastText)||"#fff"},field:{display:"flex",flexWrap:"wrap"},fieldDescription:{"&:hover":{background:"dark"===e.palette.mode?"#e65100":"yellow"}},fieldName:{wordBreak:"break-all",minWidth:90,borderBottom:"1px solid #0003",fontSize:12,background:e.palette.action.disabledBackground,marginRight:e.spacing(1),padding:e.spacing(.5)},fieldValue:{wordBreak:"break-word",maxHeight:300,fontSize:12,padding:e.spacing(.5),overflow:"auto"},fieldSubvalue:{wordBreak:"break-word",maxHeight:300,padding:e.spacing(.5),background:e.palette.action.disabledBackground,border:"1px solid ".concat(e.palette.action.disabledBackground),boxSizing:"border-box",overflow:"auto"}}}));function $(e){var n=e.children,t=e.title,r=e.defaultExpanded,i=void 0===r||r,a=Y().classes,o=(0,c.useState)(i),u=(0,s.Z)(o,2),m=u[0],x=u[1];return(0,O.jsxs)(l.Z,{expanded:m,onChange:function(){return x((function(e){return!e}))},TransitionProps:{unmountOnExit:!0,timeout:150},children:[(0,O.jsx)(d.Z,{expandIcon:(0,O.jsx)(w.Z,{className:a.expandIcon}),children:(0,O.jsxs)(f.Z,{variant:"button",children:[" ",t]})}),(0,O.jsx)(p.Z,{className:a.expansionPanelDetails,children:n})]})}var ee=function(e){var n=e.description,t=e.name,r=e.width,i=e.prefix,a=void 0===i?[]:i,s=Y(),c=s.classes,u=s.cx,l=[].concat((0,o.Z)(a),[t]).join(".");return n?(0,O.jsx)(m.Z,{title:n,placement:"left",children:(0,O.jsx)("div",{className:u(c.fieldDescription,c.fieldName),children:l})}):(0,O.jsx)("div",{className:c.fieldName,style:{width:r},children:l})},ne=function(e){var n=e.value,t=Y().classes,r="".concat(n).match(/^https?:\/\//);return(0,O.jsx)("div",{className:t.fieldValue,children:c.isValidElement(n)?n:r?(0,O.jsx)(x.Z,{href:"".concat(n),children:"".concat(n)}):(0,O.jsx)(S.SanitizedHTML,{html:b()(n)?JSON.stringify(n):String(n)})})};function te(e){var n=e.name,t=e.value,r=e.description,i=e.prefix,a=e.width,o=Y().classes;return null!==t&&void 0!==t?(0,O.jsxs)("div",{className:o.field,children:[(0,O.jsx)(ee,{prefix:i,description:r,name:n,width:a}),(0,O.jsx)(ne,{value:t})]}):null}function re(e){var n=e.name,t=e.value,r=e.description,i=e.prefix,a=void 0===i?[]:i,s=Y().classes;return 1===t.length?b()(t[0])?(0,O.jsx)(de,{attributes:t[0],prefix:[].concat((0,o.Z)(a),[n])}):(0,O.jsxs)("div",{className:s.field,children:[(0,O.jsx)(ee,{prefix:a,description:r,name:n}),(0,O.jsx)(ne,{value:t[0]})]}):t.every((function(e){return b()(e)}))?(0,O.jsx)(O.Fragment,{children:t.map((function(e,t){return(0,O.jsx)(de,{attributes:e,prefix:[].concat((0,o.Z)(a),[n+"-"+t])},JSON.stringify(e)+"-"+t)}))}):(0,O.jsxs)("div",{className:s.field,children:[(0,O.jsx)(ee,{prefix:a,description:r,name:n}),t.map((function(e,n){return(0,O.jsx)("div",{className:s.fieldSubvalue,children:(0,O.jsx)(ne,{value:e})},JSON.stringify(e)+"-"+n)}))]})}var ie=function(e){return e.toLocaleString("en-US")};function ae(e){var n=e.feature,t=n.strand,r={"-1":"-",0:"",1:"+"},i=r[t]?"(".concat(r[t],")"):"",a=(0,y.assembleLocString)(n);return(0,O.jsx)(O.Fragment,{children:"".concat(a," ").concat(i)})}function oe(e){var n=e.feature,t=(0,a.Z)((0,a.Z)({},n),n.__jbrowsefmt),r=t.start,i=t.end,o=(0,a.Z)((0,a.Z)({},t),{},{length:ie(i-r)});return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(te,{name:"Position",value:(0,O.jsx)(ae,(0,a.Z)((0,a.Z)({},e),{},{feature:t}))}),Object.entries({description:"Description",name:"Name",length:"Length",type:"Type"}).map((function(e){var n=(0,s.Z)(e,2),t=n[0];return[n[1],o[t]]})).filter((function(e){return null!=(0,s.Z)(e,2)[1]})).map((function(e){var n=(0,s.Z)(e,2),t=n[0],r=n[1];return(0,O.jsx)(te,{name:t,value:r},t)}))]})}var se=function(e){return(0,O.jsx)($,(0,a.Z)((0,a.Z)({},e),{},{title:"Primary data",children:(0,O.jsx)(oe,(0,a.Z)({},e))}))};function ce(e){var n=e.value,t=(0,y.getUriLink)(n);return(0,O.jsx)(S.SanitizedHTML,{html:'<a href="'.concat(t,'">').concat(t,"</a>")})}function ue(e){var n,t=e.value,c=e.prefix,u=e.name,l=Object.keys(t[0]).sort(),d=new Set(l),f=(0,i.Z)(t);try{for(f.s();!(n=f.n()).done;)for(var p=n.value,m=0,x=Object.keys(p);m<x.length;m++){var v=x[m];d.add(v)}}catch(S){f.e(S)}finally{f.f()}if(d.size<l.length+5){var h,j=Object.entries(t).map((function(e){var n=(0,s.Z)(e,2),t=n[0],i=n[1],o=i.id,c=(0,r.Z)(i,J);return(0,a.Z)({id:t,identifier:o},c)}));d.has("id")?(d.delete("id"),h=["identifier"].concat((0,o.Z)(d))):h=(0,o.Z)(d);var g=h.map((function(e){return{field:e,renderCell:function(e){var n=e.value;return(0,y.isUriLocation)(n)?(0,O.jsx)(ce,{value:n}):(0,y.getStr)(n)},width:(0,y.measureGridWidth)(j.map((function(n){return n[e]})))}})),b=j.length<100,w=25*Math.min(j.length,100)+80+(b?0:50);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(ee,{prefix:c,name:u}),(0,O.jsx)("div",{style:{height:w,width:"100%"},children:(0,O.jsx)(Z._,{disableSelectionOnClick:!0,rowHeight:25,rows:j,hideFooterSelectedRowCount:!0,columns:g,hideFooter:b})})]})}return null}function le(e){var n,t=e.value,r=e.prefix,i=e.name,a=Y().classes,o=t.uri,s=t.baseUri,c=void 0===s?"":s;try{n=new URL(o,c).href}catch(u){n=o}return(0,O.jsxs)("div",{className:a.field,children:[(0,O.jsx)(ee,{prefix:r,name:i}),(0,O.jsx)(ne,{value:n})]})}function de(e){var n=e.attributes,t=e.omit,i=void 0===t?[]:t,u=e.omitSingleLevel,l=void 0===u?[]:u,d=e.descriptions,f=e.formatter,p=void 0===f?function(e){return e}:f,m=e.hideUris,x=e.prefix,v=void 0===x?[]:x,h=new Set([].concat((0,o.Z)(i),Q,(0,o.Z)(l))),Z=n.__jbrowsefmt,j=(0,r.Z)(n,V),g=(0,a.Z)((0,a.Z)({},j),Z),w=function(e,n){var t=[];return e.forEach((function(e){var r=[].concat((0,o.Z)(n),[e[0]]).join(".");t.push((0,y.measureText)(r,12))})),Math.ceil(Math.max.apply(Math,t))+10}(Object.entries(g).filter((function(e){var n=(0,s.Z)(e,2),t=n[0];return void 0!==n[1]&&!h.has(t)})),v);return(0,O.jsx)(O.Fragment,{children:Object.entries(g).filter((function(e){var n=(0,s.Z)(e,2),t=n[0];return void 0!==n[1]&&!h.has(t)})).map((function(n){var t=(0,s.Z)(n,2),i=t[0],u=t[1],l=function(e){var n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){t&&(t=t[e])})),"string"===typeof t?t:"string"===typeof(null===(n=t)||void 0===n?void 0:n.Description)?t.Description:void 0}([].concat((0,o.Z)(v),[i]),d);if(Array.isArray(u))return u.length>1&&u.every((function(e){return b()(e)}))?(0,O.jsx)(ue,{name:i,prefix:v,value:u},i):(0,O.jsx)(re,{name:i,value:u,description:l,prefix:v},i);if(b()(u)){e.omitSingleLevel;var f=(0,r.Z)(e,W);return(0,y.isUriLocation)(u)?m?null:(0,O.jsx)(le,{name:i,prefix:v,value:u},i):(0,c.createElement)(de,(0,a.Z)((0,a.Z)({},f),{},{key:i,attributes:u,descriptions:d,prefix:[].concat((0,o.Z)(v),[i])}))}return(0,O.jsx)(te,{name:i,value:p(u,i),description:l,prefix:v,width:Math.min(w,K)},i)}))})}var fe=function(e){var n=e.feature;return(0,O.jsx)($,(0,a.Z)((0,a.Z)({},e),{},{title:"Attributes",children:(0,O.jsx)(de,(0,a.Z)((0,a.Z)({},e),{},{attributes:n}))}))};function pe(e,n,t){return[(0,P.Cn)("".concat(e)||"".concat(n)),"".concat(t)].filter((function(e){return!!e})).join(" - ")}function me(e){var n=e.omit,t=void 0===n?[]:n,r=e.model,i=e.feature,o=e.depth,s=void 0===o?0:o,c=i.mate,l=i.name,d=void 0===l?"":l,p=i.id,m=void 0===p?"":p,x=i.type,h=void 0===x?"":x,Z=i.subfeatures,j=(0,y.getEnv)(r).pluginManager,g=(0,y.getSession)(r),b=j.evaluateExtensionPoint("Core-extraFeaturePanel",null,{session:g,feature:i,model:r});return(0,O.jsxs)($,{title:pe(d,m,h),children:[(0,O.jsx)(f.Z,{children:"Core details"}),(0,O.jsx)(oe,(0,a.Z)({},e)),c?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.Z,{}),(0,O.jsx)(f.Z,{children:"Mate details"}),(0,O.jsx)(oe,(0,a.Z)((0,a.Z)({},e),{},{feature:c}))]}):null,(0,O.jsx)(v.Z,{}),(0,O.jsx)(f.Z,{children:"Attributes"}),(0,O.jsx)(de,(0,a.Z)((0,a.Z)({attributes:i},e),{},{omit:t,omitSingleLevel:X})),(0,O.jsx)(u.ErrorBoundary,{FallbackComponent:function(e){var n=e.error;return(0,O.jsx)(S.ErrorMessage,{error:n})},children:(0,O.jsx)(G,(0,a.Z)({},e))}),b?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.Z,{}),(0,O.jsx)($,{title:b.name,children:(0,O.jsx)(b.Component,(0,a.Z)({},e))})]}):null,null!==Z&&void 0!==Z&&Z.length?(0,O.jsx)($,{title:"Subfeatures",defaultExpanded:s<1,children:Z.map((function(e){return(0,O.jsx)(me,{feature:e,model:r,depth:s+1},JSON.stringify(e))}))}):null]})}var xe=(0,j.observer)((function(e){var n=e.model,t=n.featureData;if(!t)return null;var r,i=JSON.parse(JSON.stringify(t,(function(e,n){return void 0===n?null:n})));return r=i,0===Object.keys(r).length?null:(0,O.jsx)(me,{model:n,feature:i})}))},89378:function(e,n,t){t.d(n,{Cn:function(){return d},D8:function(){return s},Wx:function(){return c},ZK:function(){return u},mw:function(){return l},zo:function(){return a}});var r=t(68079),i=t(33028);function a(e,n){return e.map((function(e){return n.slice(e.start,e.end)})).join("")}function o(e){return"".concat(e.start,"-").concat(e.end)}function s(e){return e.filter((function(e,n,t){return!n||o(e)!==o(t[n-1])}))}function c(e,n){return e.map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{start:n-e.end,end:n-e.start})})).sort((function(e,n){return e.start-n.start}))}function u(e,n){var t=e[0],a=e[e.length-1],o=n.findIndex((function(e){return e.end>=t.start&&e.start<=t.start})),s=n.findIndex((function(e){return e.end>=a.end&&e.start<=a.end})),c=n[s],u=n[o],l=[].concat((0,r.Z)(n.slice(0,o)),[{start:u.start,end:t.start}]).map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"five_prime_UTR"})})),d=[{start:a.end,end:c.end}].concat((0,r.Z)(n.slice(s+1))).map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"three_prime_UTR"})}));return[].concat((0,r.Z)(l),(0,r.Z)(d))}function l(e,n){var t=e[0],a=e[e.length-1],o=[{start:n.start,end:t.start}].map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"five_prime_UTR"})})),s=[{start:a.end,end:n.end}].map((function(e){return(0,i.Z)((0,i.Z)({},e),{},{type:"three_prime_UTR"})}));return[].concat((0,r.Z)(o),(0,r.Z)(s))}function d(e){return e.length>20?"".concat(e.slice(0,20),"..."):e}}}]);
//# sourceMappingURL=8941.dea7ff04.chunk.js.map